exports.ids=[2],exports.modules={790:function(t,e,i){"use strict";var r;function n(t){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};function o(t,e,i){if(4!==e.length)throw new a.exception.invalid("invalid aes block size");var r=t.i[i],n=e[0]^r[0],o=e[i?3:1]^r[1],s=e[2]^r[2];e=e[i?1:3]^r[3];var c,h,f,u,l=r.length/4-2,d=4,b=[0,0,0,0];t=(c=t.M[i])[0];var p=c[1],m=c[2],F=c[3],B=c[4];for(u=0;u<l;u++)c=t[n>>>24]^p[o>>16&255]^m[s>>8&255]^F[255&e]^r[d],h=t[o>>>24]^p[s>>16&255]^m[e>>8&255]^F[255&n]^r[d+1],f=t[s>>>24]^p[e>>16&255]^m[n>>8&255]^F[255&o]^r[d+2],e=t[e>>>24]^p[n>>16&255]^m[o>>8&255]^F[255&s]^r[d+3],d+=4,n=c,o=h,s=f;for(u=0;4>u;u++)b[i?3&-u:u]=B[n>>>24]<<24^B[o>>16&255]<<16^B[s>>8&255]<<8^B[255&e]^r[d++],c=n,n=o,o=s,s=e,e=c;return b}function s(t,e){var i,r=a.random.$[t],n=[];for(i in r)r.hasOwnProperty(i)&&n.push(r[i]);for(i=0;i<n.length;i++)n[i](e)}function c(t,e){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?t.addEntropy(window.performance.now(),e,"loadtime"):t.addEntropy((new Date).valueOf(),e,"loadtime")}function h(t){t.i=f(t).concat(f(t)),t.aa=new a.cipher.aes(t.i)}function f(t){for(var e=0;4>e&&(t.F[e]=t.F[e]+1|0,!t.F[e]);e++);return t.aa.encrypt(t.F)}function u(t,e){return function(){e.apply(t,arguments)}}a.cipher.aes=function(t){this.M[0][0][0]||this.T();var e,i,r,n,o=this.M[0][4],s=this.M[1],c=1;if(4!==(e=t.length)&&6!==e&&8!==e)throw new a.exception.invalid("invalid aes key size");for(this.i=[r=t.slice(0),n=[]],t=e;t<4*e+28;t++)i=r[t-1],(0===t%e||8===e&&4===t%e)&&(i=o[i>>>24]<<24^o[i>>16&255]<<16^o[i>>8&255]<<8^o[255&i],0===t%e&&(i=i<<8^i>>>24^c<<24,c=c<<1^283*(c>>7))),r[t]=r[t-e]^i;for(e=0;t;e++,t--)i=r[3&e?t:t-4],n[e]=4>=t||4>e?i:s[0][o[i>>>24]]^s[1][o[i>>16&255]]^s[2][o[i>>8&255]]^s[3][o[255&i]]},a.cipher.aes.prototype={encrypt:function(t){return o(this,t,0)},decrypt:function(t){return o(this,t,1)},M:[[[],[],[],[],[]],[[],[],[],[],[]]],T:function(){var t,e,i,r,n,a,o,s=this.M[0],c=this.M[1],h=s[4],f=c[4],u=[],l=[];for(t=0;256>t;t++)l[(u[t]=t<<1^283*(t>>7))^t]=t;for(e=i=0;!h[e];e^=r||1,i=l[i]||1)for(a=(a=i^i<<1^i<<2^i<<3^i<<4)>>8^255&a^99,h[e]=a,f[a]=e,o=16843009*(n=u[t=u[r=u[e]]])^65537*t^257*r^16843008*e,n=257*u[a]^16843008*a,t=0;4>t;t++)s[t][e]=n=n<<24^n>>>8,c[t][a]=o=o<<24^o>>>8;for(t=0;5>t;t++)s[t]=s[t].slice(0),c[t]=c[t].slice(0)}},a.bitArray={bitSlice:function(t,e,i){return t=a.bitArray.ra(t.slice(e/32),32-(31&e)).slice(1),void 0===i?t:a.bitArray.clamp(t,i-e)},extract:function(t,e,i){var r=Math.floor(-e-i&31);return(-32&(e+i-1^e)?t[e/32|0]<<32-r^t[e/32+1|0]>>>r:t[e/32|0]>>>r)&(1<<i)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var i=t[t.length-1],r=a.bitArray.getPartial(i);return 32===r?t.concat(e):a.bitArray.ra(e,r,0|i,t.slice(0,t.length-1))},bitLength:function(t){var e=t.length;return 0===e?0:32*(e-1)+a.bitArray.getPartial(t[e-1])},clamp:function(t,e){if(32*t.length<e)return t;var i=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,0<i&&e&&(t[i-1]=a.bitArray.partial(e,t[i-1]&2147483648>>e-1,1)),t},partial:function(t,e,i){return 32===t?e:(i?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(a.bitArray.bitLength(t)!==a.bitArray.bitLength(e))return!1;var i,r=0;for(i=0;i<t.length;i++)r|=t[i]^e[i];return 0===r},ra:function(t,e,i,r){var n;for(n=0,void 0===r&&(r=[]);32<=e;e-=32)r.push(i),i=0;if(0===e)return r.concat(t);for(n=0;n<t.length;n++)r.push(i|t[n]>>>e),i=t[n]<<32-e;return n=t.length?t[t.length-1]:0,t=a.bitArray.getPartial(n),r.push(a.bitArray.partial(e+t&31,32<e+t?i:r.pop(),1)),r},l:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){var e,i;for(e=0;e<t.length;++e)i=t[e],t[e]=i>>>24|i>>>8&65280|(65280&i)<<8|i<<24;return t}},a.codec.utf8String={fromBits:function(t){var e,i,r="",n=a.bitArray.bitLength(t);for(e=0;e<n/8;e++)0===(3&e)&&(i=t[e/4]),r+=String.fromCharCode(i>>>8>>>8>>>8),i<<=8;return decodeURIComponent(escape(r))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,i=[],r=0;for(e=0;e<t.length;e++)r=r<<8|t.charCodeAt(e),3===(3&e)&&(i.push(r),r=0);return 3&e&&i.push(a.bitArray.partial(8*(3&e),r)),i}},a.codec.hex={fromBits:function(t){var e,i="";for(e=0;e<t.length;e++)i+=(0xf00000000000+(0|t[e])).toString(16).substr(4);return i.substr(0,a.bitArray.bitLength(t)/4)},toBits:function(t){var e,i,r=[];for(i=(t=t.replace(/\s|0x/g,"")).length,t+="00000000",e=0;e<t.length;e+=8)r.push(0^parseInt(t.substr(e,8),16));return a.bitArray.clamp(r,4*i)}},a.codec.base32={D:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",la:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(t,e,i){var r=a.codec.base32.BASE,n=a.codec.base32.REMAINING,o="",s=0,c=a.codec.base32.D,h=0,f=a.bitArray.bitLength(t);for(i&&(c=a.codec.base32.la),i=0;o.length*r<f;)o+=c.charAt((h^t[i]>>>s)>>>n),s<r?(h=t[i]<<r-s,s+=n,i++):(h<<=r,s-=r);for(;7&o.length&&!e;)o+="=";return o},toBits:function(t,e){t=t.replace(/\s|=/g,"").toUpperCase();var i,r,n=a.codec.base32.BITS,o=a.codec.base32.BASE,s=a.codec.base32.REMAINING,c=[],h=0,f=a.codec.base32.D,u=0,l="base32";for(e&&(f=a.codec.base32.la,l="base32hex"),i=0;i<t.length;i++){if(0>(r=f.indexOf(t.charAt(i)))){if(!e)try{return a.codec.base32hex.toBits(t)}catch(t){}throw new a.exception.invalid("this isn't "+l+"!")}h>s?(h-=s,c.push(u^r>>>h),u=r<<n-h):u^=r<<n-(h+=o)}return 56&h&&c.push(a.bitArray.partial(56&h,u,1)),c}},a.codec.base32hex={fromBits:function(t,e){return a.codec.base32.fromBits(t,e,1)},toBits:function(t){return a.codec.base32.toBits(t,1)}},a.codec.base64={D:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,i){var r="",n=0,o=a.codec.base64.D,s=0,c=a.bitArray.bitLength(t);for(i&&(o=o.substr(0,62)+"-_"),i=0;6*r.length<c;)r+=o.charAt((s^t[i]>>>n)>>>26),6>n?(s=t[i]<<6-n,n+=26,i++):(s<<=6,n-=6);for(;3&r.length&&!e;)r+="=";return r},toBits:function(t,e){t=t.replace(/\s|=/g,"");var i,r,n=[],o=0,s=a.codec.base64.D,c=0;for(e&&(s=s.substr(0,62)+"-_"),i=0;i<t.length;i++){if(0>(r=s.indexOf(t.charAt(i))))throw new a.exception.invalid("this isn't base64!");26<o?(o-=26,n.push(c^r>>>o),c=r<<32-o):c^=r<<32-(o+=6)}return 56&o&&n.push(a.bitArray.partial(56&o,c,1)),n}},a.codec.base64url={fromBits:function(t){return a.codec.base64.fromBits(t,1,1)},toBits:function(t){return a.codec.base64.toBits(t,1)}},a.codec.bytes={fromBits:function(t){var e,i,r=[],n=a.bitArray.bitLength(t);for(e=0;e<n/8;e++)0===(3&e)&&(i=t[e/4]),r.push(i>>>24),i<<=8;return r},toBits:function(t){var e,i=[],r=0;for(e=0;e<t.length;e++)r=r<<8|t[e],3===(3&e)&&(i.push(r),r=0);return 3&e&&i.push(a.bitArray.partial(8*(3&e),r)),i}},a.codec.z85={D:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.-:+=^!/*?&<>()[]{}@%$#",ya:[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0],fromBits:function(t){if(!t)return null;if(0!==a.bitArray.bitLength(t)%32)throw new a.exception.invalid("Invalid bitArray length!");for(var e="",i=a.codec.z85.D,r=0;r<t.length;++r){for(var n=t[r],o=0,s=0;4>s;++s)o=256*o+(n>>>8*(4-s-1)&255);for(n=52200625;n;)e+=i.charAt(Math.floor(o/n)%85),n=Math.floor(n/85)}if(e.length!==5*t.length)throw new a.exception.invalid("Bad Z85 conversion!");return e},toBits:function(t){if(!t)return[];if(0!==t.length%5)throw new a.exception.invalid("Invalid Z85 string!");for(var e=[],i=0,r=a.codec.z85.ya,n=0,o=0,s=0;s<t.length;)if(i=85*i+r[t[s++].charCodeAt(0)-32],0===s%5){for(var c=16777216;c;)n=n*Math.pow(2,8)+Math.floor(i/c)%256,4===++o&&(e.push(n),o=n=0),c=Math.floor(c/256);i=0}return e}},a.hash.sha256=function(t){this.i[0]||this.T(),t?(this.c=t.c.slice(0),this.h=t.h.slice(0),this.f=t.f):this.reset()},a.hash.sha256.hash=function(t){return(new a.hash.sha256).update(t).finalize()},a.hash.sha256.prototype={blockSize:512,reset:function(){return this.c=this.A.slice(0),this.h=[],this.f=0,this},update:function(t){"string"===typeof t&&(t=a.codec.utf8String.toBits(t));var e,i=this.h=a.bitArray.concat(this.h,t);if(e=this.f,9007199254740991<(t=this.f=e+a.bitArray.bitLength(t)))throw new a.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var r=new Uint32Array(i),n=0;for(e=512+e-(512+e&511);e<=t;e+=512)this.m(r.subarray(16*n,16*(n+1))),n+=1;i.splice(0,16*n)}else for(e=512+e-(512+e&511);e<=t;e+=512)this.m(i.splice(0,16));return this},finalize:function(){var t,e=this.h,i=this.c;for(t=(e=a.bitArray.concat(e,[a.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this.f/4294967296)),e.push(0|this.f);e.length;)this.m(e.splice(0,16));return this.reset(),i},A:[],i:[],T:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}for(var e,i,r=0,n=2;64>r;n++){for(i=!0,e=2;e*e<=n;e++)if(0===n%e){i=!1;break}i&&(8>r&&(this.A[r]=t(Math.pow(n,.5))),this.i[r]=t(Math.pow(n,1/3)),r++)}},m:function(t){var e,i,r,n=this.c,a=this.i,o=n[0],s=n[1],c=n[2],h=n[3],f=n[4],u=n[5],l=n[6],d=n[7];for(e=0;64>e;e++)16>e?i=t[e]:(i=t[e+1&15],r=t[e+14&15],i=t[15&e]=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+t[15&e]+t[e+9&15]|0),i=i+d+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(l^f&(u^l))+a[e],d=l,l=u,u=f,f=h+i|0,h=c,c=s,o=i+((s=o)&c^h&(s^c))+(s>>>2^s>>>13^s>>>22^s<<30^s<<19^s<<10)|0;n[0]=n[0]+o|0,n[1]=n[1]+s|0,n[2]=n[2]+c|0,n[3]=n[3]+h|0,n[4]=n[4]+f|0,n[5]=n[5]+u|0,n[6]=n[6]+l|0,n[7]=n[7]+d|0}},a.hash.sha512=function(t){this.i[0]||this.T(),t?(this.c=t.c.slice(0),this.h=t.h.slice(0),this.f=t.f):this.reset()},a.hash.sha512.hash=function(t){return(new a.hash.sha512).update(t).finalize()},a.hash.sha512.prototype={blockSize:1024,reset:function(){return this.c=this.A.slice(0),this.h=[],this.f=0,this},update:function(t){"string"===typeof t&&(t=a.codec.utf8String.toBits(t));var e,i=this.h=a.bitArray.concat(this.h,t);if(e=this.f,9007199254740991<(t=this.f=e+a.bitArray.bitLength(t)))throw new a.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var r=new Uint32Array(i),n=0;for(e=1024+e-(1024+e&1023);e<=t;e+=1024)this.m(r.subarray(32*n,32*(n+1))),n+=1;i.splice(0,32*n)}else for(e=1024+e-(1024+e&1023);e<=t;e+=1024)this.m(i.splice(0,32));return this},finalize:function(){var t,e=this.h,i=this.c;for(t=(e=a.bitArray.concat(e,[a.bitArray.partial(1,1)])).length+4;31&t;t++)e.push(0);for(e.push(0),e.push(0),e.push(Math.floor(this.f/4294967296)),e.push(0|this.f);e.length;)this.m(e.splice(0,32));return this.reset(),i},A:[],Fa:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],i:[],Ha:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],T:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}function e(t){return 1099511627776*(t-Math.floor(t))&255}for(var i,r,n=0,a=2;80>n;a++){for(r=!0,i=2;i*i<=a;i++)if(0===a%i){r=!1;break}r&&(8>n&&(this.A[2*n]=t(Math.pow(a,.5)),this.A[2*n+1]=e(Math.pow(a,.5))<<24|this.Fa[n]),this.i[2*n]=t(Math.pow(a,1/3)),this.i[2*n+1]=e(Math.pow(a,1/3))<<24|this.Ha[n],n++)}},m:function(t){var e,i,r,n=this.c,a=this.i,o=n[0],s=n[1],c=n[2],h=n[3],f=n[4],u=n[5],l=n[6],d=n[7],b=n[8],p=n[9],m=n[10],F=n[11],B=n[12],A=n[13],y=n[14],E=n[15];if("undefined"!==typeof Uint32Array){r=Array(160);for(var C=0;32>C;C++)r[C]=t[C]}else r=t;C=o;var g=s,D=c,v=h,w=f,x=u,M=l,k=d,L=b,z=p,S=m,q=F,U=B,j=A,K=y,O=E;for(t=0;80>t;t++){if(16>t)e=r[2*t],i=r[2*t+1];else{i=r[2*(t-15)],e=((R=r[2*(t-15)+1])<<31|i>>>1)^(R<<24|i>>>8)^i>>>7;var I=(i<<31|R>>>1)^(i<<24|R>>>8)^(i<<25|R>>>7);i=r[2*(t-2)];var R=((P=r[2*(t-2)+1])<<13|i>>>19)^(i<<3|P>>>29)^i>>>6,P=(i<<13|P>>>19)^(P<<3|i>>>29)^(i<<26|P>>>6),V=r[2*(t-7)],G=r[2*(t-16)],T=r[2*(t-16)+1];e=e+V+((i=I+r[2*(t-7)+1])>>>0<I>>>0?1:0),e+=R+((i+=P)>>>0<P>>>0?1:0),e+=G+((i+=T)>>>0<T>>>0?1:0)}r[2*t]=e|=0,r[2*t+1]=i|=0;V=L&S^~L&U;var J=z&q^~z&j,N=(P=C&D^C&w^D&w,g&v^g&x^v&x),W=(G=(g<<4|C>>>28)^(C<<30|g>>>2)^(C<<25|g>>>7),T=(C<<4|g>>>28)^(g<<30|C>>>2)^(g<<25|C>>>7),a[2*t]),X=a[2*t+1];I=K+((z<<18|L>>>14)^(z<<14|L>>>18)^(L<<23|z>>>9))+((R=O+((L<<18|z>>>14)^(L<<14|z>>>18)^(z<<23|L>>>9)))>>>0<O>>>0?1:0);K=U,O=j,U=S,j=q,S=L,q=z,L=M+(I=(I=(I=I+(V+((R=R+J)>>>0<J>>>0?1:0)))+(W+((R=R+X)>>>0<X>>>0?1:0)))+(e+((R=R+i|0)>>>0<i>>>0?1:0)))+((z=k+R|0)>>>0<k>>>0?1:0)|0,M=w,k=x,w=D,x=v,D=C,v=g,C=I+(e=G+P+((i=T+N)>>>0<T>>>0?1:0))+((g=R+i|0)>>>0<R>>>0?1:0)|0}s=n[1]=s+g|0,n[0]=o+C+(s>>>0<g>>>0?1:0)|0,h=n[3]=h+v|0,n[2]=c+D+(h>>>0<v>>>0?1:0)|0,u=n[5]=u+x|0,n[4]=f+w+(u>>>0<x>>>0?1:0)|0,d=n[7]=d+k|0,n[6]=l+M+(d>>>0<k>>>0?1:0)|0,p=n[9]=p+z|0,n[8]=b+L+(p>>>0<z>>>0?1:0)|0,F=n[11]=F+q|0,n[10]=m+S+(F>>>0<q>>>0?1:0)|0,A=n[13]=A+j|0,n[12]=B+U+(A>>>0<j>>>0?1:0)|0,E=n[15]=E+O|0,n[14]=y+K+(E>>>0<O>>>0?1:0)|0}},a.hash.sha1=function(t){t?(this.c=t.c.slice(0),this.h=t.h.slice(0),this.f=t.f):this.reset()},a.hash.sha1.hash=function(t){return(new a.hash.sha1).update(t).finalize()},a.hash.sha1.prototype={blockSize:512,reset:function(){return this.c=this.A.slice(0),this.h=[],this.f=0,this},update:function(t){"string"===typeof t&&(t=a.codec.utf8String.toBits(t));var e,i=this.h=a.bitArray.concat(this.h,t);if(e=this.f,9007199254740991<(t=this.f=e+a.bitArray.bitLength(t)))throw new a.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var r=new Uint32Array(i),n=0;for(e=this.blockSize+e-(this.blockSize+e&this.blockSize-1);e<=t;e+=this.blockSize)this.m(r.subarray(16*n,16*(n+1))),n+=1;i.splice(0,16*n)}else for(e=this.blockSize+e-(this.blockSize+e&this.blockSize-1);e<=t;e+=this.blockSize)this.m(i.splice(0,16));return this},finalize:function(){var t,e=this.h,i=this.c;for(t=(e=a.bitArray.concat(e,[a.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this.f/4294967296)),e.push(0|this.f);e.length;)this.m(e.splice(0,16));return this.reset(),i},A:[1732584193,4023233417,2562383102,271733878,3285377520],i:[1518500249,1859775393,2400959708,3395469782],m:function(t){var e,i,r,n,a,o,s,c=this.c;if("undefined"!==typeof Uint32Array)for(s=Array(80),i=0;16>i;i++)s[i]=t[i];else s=t;for(i=c[0],r=c[1],n=c[2],a=c[3],o=c[4],t=0;79>=t;t++)16<=t&&(e=s[t-3]^s[t-8]^s[t-14]^s[t-16],s[t]=e<<1|e>>>31),e=(i<<5|i>>>27)+(e=19>=t?r&n|~r&a:39>=t?r^n^a:59>=t?r&n|r&a|n&a:79>=t?r^n^a:void 0)+o+s[t]+this.i[Math.floor(t/20)]|0,o=a,a=n,n=r<<30|r>>>2,r=i,i=e;c[0]=c[0]+i|0,c[1]=c[1]+r|0,c[2]=c[2]+n|0,c[3]=c[3]+a|0,c[4]=c[4]+o|0}},a.mode.ccm={name:"ccm",W:[],listenProgress:function(t){a.mode.ccm.W.push(t)},unListenProgress:function(t){-1<(t=a.mode.ccm.W.indexOf(t))&&a.mode.ccm.W.splice(t,1)},ha:function(t){var e,i=a.mode.ccm.W.slice();for(e=0;e<i.length;e+=1)i[e](t)},encrypt:function(t,e,i,r,n){var o,s=e.slice(0),c=a.bitArray,h=c.bitLength(i)/8,f=c.bitLength(s)/8;if(n=n||64,r=r||[],7>h)throw new a.exception.invalid("ccm: iv must be at least 7 bytes");for(o=2;4>o&&f>>>8*o;o++);return o<15-h&&(o=15-h),i=c.clamp(i,8*(15-o)),e=a.mode.ccm.R(t,e,i,r,n,o),s=a.mode.ccm.u(t,s,i,e,n,o),c.concat(s.data,s.tag)},decrypt:function(t,e,i,r,n){n=n||64,r=r||[];var o=a.bitArray,s=o.bitLength(i)/8,c=o.bitLength(e),h=o.clamp(e,c-n),f=o.bitSlice(e,c-n);c=(c-n)/8;if(7>s)throw new a.exception.invalid("ccm: iv must be at least 7 bytes");for(e=2;4>e&&c>>>8*e;e++);if(e<15-s&&(e=15-s),i=o.clamp(i,8*(15-e)),h=a.mode.ccm.u(t,h,i,f,n,e),t=a.mode.ccm.R(t,h.data,i,r,n,e),!o.equal(h.tag,t))throw new a.exception.corrupt("ccm: tag doesn't match");return h.data},oa:function(t,e,i,r,n,o){var s=[],c=a.bitArray,h=c.l;if(r=[c.partial(8,(e.length?64:0)|r-2<<2|o-1)],(r=c.concat(r,i))[3]|=n,r=t.encrypt(r),e.length)for(65279>=(i=c.bitLength(e)/8)?s=[c.partial(16,i)]:4294967295>=i&&(s=c.concat([c.partial(16,65534)],[i])),s=c.concat(s,e),e=0;e<s.length;e+=4)r=t.encrypt(h(r,s.slice(e,e+4).concat([0,0,0])));return r},R:function(t,e,i,r,n,o){var s=a.bitArray,c=s.l;if((n/=8)%2||4>n||16<n)throw new a.exception.invalid("ccm: invalid tag length");if(4294967295<r.length||4294967295<e.length)throw new a.exception.bug("ccm: can't deal with 4GiB or more data");for(i=a.mode.ccm.oa(t,r,i,n,s.bitLength(e)/8,o),r=0;r<e.length;r+=4)i=t.encrypt(c(i,e.slice(r,r+4).concat([0,0,0])));return s.clamp(i,8*n)},u:function(t,e,i,r,n,o){var s,c=a.bitArray;s=c.l;var h=e.length,f=c.bitLength(e),u=h/50,l=u;if(i=c.concat([c.partial(8,o-1)],i).concat([0,0,0]).slice(0,4),r=c.bitSlice(s(r,t.encrypt(i)),0,n),!h)return{tag:r,data:[]};for(s=0;s<h;s+=4)s>u&&(a.mode.ccm.ha(s/h),u+=l),i[3]++,n=t.encrypt(i),e[s]^=n[0],e[s+1]^=n[1],e[s+2]^=n[2],e[s+3]^=n[3];return{tag:r,data:c.clamp(e,f)}}},a.mode.ctr={name:"ctr",encrypt:function(t,e,i,r){return a.mode.ctr.ga(t,e,i,r)},decrypt:function(t,e,i,r){return a.mode.ctr.ga(t,e,i,r)},ga:function(t,e,i,r){var n,o,s;if(r&&r.length)throw new a.exception.invalid("ctr can't authenticate data");if(128!==a.bitArray.bitLength(i))throw new a.exception.invalid("ctr iv must be 128 bits");if(!(r=e.length))return[];for(i=i.slice(0),n=e.slice(0),e=a.bitArray.bitLength(n),s=0;s<r;s+=4)o=t.encrypt(i),n[s]^=o[0],n[s+1]^=o[1],n[s+2]^=o[2],n[s+3]^=o[3],i[3]++;return a.bitArray.clamp(n,e)}},void 0===a.beware&&(a.beware={}),a.beware["CBC mode is dangerous because it doesn't protect message integrity."]=function(){a.mode.cbc={name:"cbc",encrypt:function(t,e,i,r){if(r&&r.length)throw new a.exception.invalid("cbc can't authenticate data");if(128!==a.bitArray.bitLength(i))throw new a.exception.invalid("cbc iv must be 128 bits");var n=a.bitArray,o=n.l,s=n.bitLength(e),c=0,h=[];if(7&s)throw new a.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(r=0;c+128<=s;r+=4,c+=128)i=t.encrypt(o(i,e.slice(r,r+4))),h.splice(r,0,i[0],i[1],i[2],i[3]);return s=16843009*(16-(s>>3&15)),i=t.encrypt(o(i,n.concat(e,[s,s,s,s]).slice(r,r+4))),h.splice(r,0,i[0],i[1],i[2],i[3]),h},decrypt:function(t,e,i,r){if(r&&r.length)throw new a.exception.invalid("cbc can't authenticate data");if(128!==a.bitArray.bitLength(i))throw new a.exception.invalid("cbc iv must be 128 bits");if(127&a.bitArray.bitLength(e)||!e.length)throw new a.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var n,o=a.bitArray,s=o.l,c=[];for(r=0;r<e.length;r+=4)n=e.slice(r,r+4),i=s(i,t.decrypt(n)),c.splice(r,0,i[0],i[1],i[2],i[3]),i=n;if(0===(n=255&c[r-1])||16<n)throw new a.exception.corrupt("pkcs#5 padding corrupt");if(i=16843009*n,!o.equal(o.bitSlice([i,i,i,i],0,8*n),o.bitSlice(c,32*c.length-8*n,32*c.length)))throw new a.exception.corrupt("pkcs#5 padding corrupt");return o.bitSlice(c,0,32*c.length-8*n)}}},a.mode.ocb2={name:"ocb2",encrypt:function(t,e,i,r,n,o){if(128!==a.bitArray.bitLength(i))throw new a.exception.invalid("ocb iv must be 128 bits");var s,c=a.mode.ocb2.U,h=a.bitArray,f=h.l,u=[0,0,0,0];i=c(t.encrypt(i));var l,d=[];for(r=r||[],n=n||64,s=0;s+4<e.length;s+=4)u=f(u,l=e.slice(s,s+4)),d=d.concat(f(i,t.encrypt(f(i,l)))),i=c(i);return l=e.slice(s),e=h.bitLength(l),s=t.encrypt(f(i,[0,0,0,e])),l=h.clamp(f(l.concat([0,0,0]),s),e),u=f(u,f(l.concat([0,0,0]),s)),u=t.encrypt(f(u,f(i,c(i)))),r.length&&(u=f(u,o?r:a.mode.ocb2.pmac(t,r))),d.concat(h.concat(l,h.clamp(u,n)))},decrypt:function(t,e,i,r,n,o){if(128!==a.bitArray.bitLength(i))throw new a.exception.invalid("ocb iv must be 128 bits");n=n||64;var s,c,h=a.mode.ocb2.U,f=a.bitArray,u=f.l,l=[0,0,0,0],d=h(t.encrypt(i)),b=a.bitArray.bitLength(e)-n,p=[];for(r=r||[],i=0;i+4<b/32;i+=4)s=u(d,t.decrypt(u(d,e.slice(i,i+4)))),l=u(l,s),p=p.concat(s),d=h(d);if(c=b-32*i,s=t.encrypt(u(d,[0,0,0,c])),s=u(s,f.clamp(e.slice(i),c).concat([0,0,0])),l=u(l,s),l=t.encrypt(u(l,u(d,h(d)))),r.length&&(l=u(l,o?r:a.mode.ocb2.pmac(t,r))),!f.equal(f.clamp(l,n),f.bitSlice(e,b)))throw new a.exception.corrupt("ocb: tag doesn't match");return p.concat(f.clamp(s,c))},pmac:function(t,e){var i,r=a.mode.ocb2.U,n=a.bitArray,o=n.l,s=[0,0,0,0],c=o(c=t.encrypt([0,0,0,0]),r(r(c)));for(i=0;i+4<e.length;i+=4)c=r(c),s=o(s,t.encrypt(o(c,e.slice(i,i+4))));return i=e.slice(i),128>n.bitLength(i)&&(c=o(c,r(c)),i=n.concat(i,[-2147483648,0,0,0])),s=o(s,i),t.encrypt(o(r(o(c,r(c))),s))},U:function(t){return[t[0]<<1^t[1]>>>31,t[1]<<1^t[2]>>>31,t[2]<<1^t[3]>>>31,t[3]<<1^135*(t[0]>>>31)]}},a.mode.ocb2progressive={createEncryptor:function(t,e,i,r,n){if(128!==a.bitArray.bitLength(e))throw new a.exception.invalid("ocb iv must be 128 bits");var o,s,c,h,f=a.mode.ocb2.U,u=a.bitArray,l=u.l,d=[0,0,0,0],b=f(t.encrypt(e)),p=[];return i=i||[],r=r||64,{process:function(e){if(0==a.bitArray.bitLength(e))return[];var i=[];for(p=p.concat(e),o=0;o+4<p.length;o+=4)s=p.slice(o,o+4),d=l(d,s),i=i.concat(l(b,t.encrypt(l(b,s)))),b=f(b);return p=p.slice(o),i},finalize:function(){return s=p,c=u.bitLength(s),h=t.encrypt(l(b,[0,0,0,c])),s=u.clamp(l(s.concat([0,0,0]),h),c),d=l(d,l(s.concat([0,0,0]),h)),d=t.encrypt(l(d,l(b,f(b)))),i.length&&(d=l(d,n?i:a.mode.ocb2.pmac(t,i))),u.concat(s,u.clamp(d,r))}}},createDecryptor:function(t,e,i,r,n){if(128!==a.bitArray.bitLength(e))throw new a.exception.invalid("ocb iv must be 128 bits");r=r||64;var o,s,c,h,f=a.mode.ocb2.U,u=a.bitArray,l=u.l,d=[0,0,0,0],b=f(t.encrypt(e)),p=[];return i=i||[],{process:function(e){if(0==e.length)return[];var i=[];for(p=p.concat(e),e=a.bitArray.bitLength(p),o=0;o+4<(e-r)/32;o+=4)s=l(b,t.decrypt(l(b,p.slice(o,o+4)))),d=l(d,s),i=i.concat(s),b=f(b);return p=p.slice(o),i},finalize:function(){if(c=a.bitArray.bitLength(p)-r,h=t.encrypt(l(b,[0,0,0,c])),s=l(h,u.clamp(p,c).concat([0,0,0])),d=l(d,s),d=t.encrypt(l(d,l(b,f(b)))),i.length&&(d=l(d,n?i:a.mode.ocb2.pmac(t,i))),!u.equal(u.clamp(d,r),u.bitSlice(p,c)))throw new a.exception.corrupt("ocb: tag doesn't match");return u.clamp(s,c)}}}},a.mode.gcm={name:"gcm",encrypt:function(t,e,i,r,n){var o=e.slice(0);return e=a.bitArray,r=r||[],t=a.mode.gcm.u(!0,t,o,r,i,n||128),e.concat(t.data,t.tag)},decrypt:function(t,e,i,r,n){var o=e.slice(0),s=a.bitArray,c=s.bitLength(o);if(r=r||[],(n=n||128)<=c?(e=s.bitSlice(o,c-n),o=s.bitSlice(o,0,c-n)):(e=o,o=[]),t=a.mode.gcm.u(!1,t,o,r,i,n),!s.equal(t.tag,e))throw new a.exception.corrupt("gcm: tag doesn't match");return t.data},Da:function(t,e){var i,r,n,o,s,c=a.bitArray.l;for(n=[0,0,0,0],o=e.slice(0),i=0;128>i;i++){for((r=0!==(t[Math.floor(i/32)]&1<<31-i%32))&&(n=c(n,o)),s=0!==(1&o[3]),r=3;0<r;r--)o[r]=o[r]>>>1|(1&o[r-1])<<31;o[0]>>>=1,s&&(o[0]^=-520093696)}return n},J:function(t,e,i){var r,n=i.length;for(e=e.slice(0),r=0;r<n;r+=4)e[0]^=4294967295&i[r],e[1]^=4294967295&i[r+1],e[2]^=4294967295&i[r+2],e[3]^=4294967295&i[r+3],e=a.mode.gcm.Da(e,t);return e},u:function(t,e,i,r,n,o){var s,c,h,f,u,l,d,b,p=a.bitArray;for(l=i.length,d=p.bitLength(i),b=p.bitLength(r),c=p.bitLength(n),s=e.encrypt([0,0,0,0]),96===c?(n=n.slice(0),n=p.concat(n,[1])):(n=a.mode.gcm.J(s,[0,0,0,0],n),n=a.mode.gcm.J(s,n,[0,0,Math.floor(c/4294967296),4294967295&c])),c=a.mode.gcm.J(s,[0,0,0,0],r),u=n.slice(0),r=c.slice(0),t||(r=a.mode.gcm.J(s,c,i)),f=0;f<l;f+=4)u[3]++,h=e.encrypt(u),i[f]^=h[0],i[f+1]^=h[1],i[f+2]^=h[2],i[f+3]^=h[3];return i=p.clamp(i,d),t&&(r=a.mode.gcm.J(s,c,i)),t=[Math.floor(b/4294967296),4294967295&b,Math.floor(d/4294967296),4294967295&d],r=a.mode.gcm.J(s,r,t),h=e.encrypt(n),r[0]^=h[0],r[1]^=h[1],r[2]^=h[2],r[3]^=h[3],{tag:p.bitSlice(r,0,o),data:i}}},a.misc.hmac=function(t,e){this.ka=e=e||a.hash.sha256;var i,r=[[],[]],n=e.prototype.blockSize/32;for(this.P=[new e,new e],t.length>n&&(t=e.hash(t)),i=0;i<n;i++)r[0][i]=909522486^t[i],r[1][i]=1549556828^t[i];this.P[0].update(r[0]),this.P[1].update(r[1]),this.ea=new e(this.P[0])},a.misc.hmac.prototype.encrypt=a.misc.hmac.prototype.mac=function(t){if(this.ta)throw new a.exception.invalid("encrypt on already updated hmac called!");return this.update(t),this.digest(t)},a.misc.hmac.prototype.reset=function(){this.ea=new this.ka(this.P[0]),this.ta=!1},a.misc.hmac.prototype.update=function(t){this.ta=!0,this.ea.update(t)},a.misc.hmac.prototype.digest=function(){var t=this.ea.finalize();t=new this.ka(this.P[1]).update(t).finalize();return this.reset(),t},a.misc.pbkdf2=function(t,e,i,r,n){if(i=i||1e4,0>r||0>i)throw new a.exception.invalid("invalid params to pbkdf2");"string"===typeof t&&(t=a.codec.utf8String.toBits(t)),"string"===typeof e&&(e=a.codec.utf8String.toBits(e)),t=new(n=n||a.misc.hmac)(t);var o,s,c,h,f=[],u=a.bitArray;for(h=1;32*f.length<(r||1);h++){for(n=o=t.encrypt(u.concat(e,[h])),s=1;s<i;s++)for(o=t.encrypt(o),c=0;c<o.length;c++)n[c]^=o[c];f=f.concat(n)}return r&&(f=u.clamp(f,r)),f},a.misc.scrypt=function(t,e,i,r,n,o,s){var c=Math.pow(2,32)-1,h=a.misc.scrypt;if(i=i||16384,(r=r||8)*(n=n||1)>=Math.pow(2,30))throw a.exception.invalid("The parameters r, p must satisfy r * p < 2^30");if(2>i||i&0!=i-1)throw a.exception.invalid("The parameter N must be a power of 2.");if(i>c/128/r)throw a.exception.invalid("N too big.");if(r>c/128/n)throw a.exception.invalid("r too big.");for(r=(e=a.misc.pbkdf2(t,e,1,128*n*r*8,s)).length/n,h.reverse(e),c=0;c<n;c++){var f=e.slice(c*r,(c+1)*r);h.blockcopy(h.ROMix(f,i),0,e,c*r)}return h.reverse(e),a.misc.pbkdf2(t,e,1,o,s)},a.misc.scrypt.salsa20Core=function(t,e){function i(t,e){return t<<e|t>>>32-e}for(var r=t.slice(0),n=e;0<n;n-=2)r[4]^=i(r[0]+r[12],7),r[8]^=i(r[4]+r[0],9),r[12]^=i(r[8]+r[4],13),r[0]^=i(r[12]+r[8],18),r[9]^=i(r[5]+r[1],7),r[13]^=i(r[9]+r[5],9),r[1]^=i(r[13]+r[9],13),r[5]^=i(r[1]+r[13],18),r[14]^=i(r[10]+r[6],7),r[2]^=i(r[14]+r[10],9),r[6]^=i(r[2]+r[14],13),r[10]^=i(r[6]+r[2],18),r[3]^=i(r[15]+r[11],7),r[7]^=i(r[3]+r[15],9),r[11]^=i(r[7]+r[3],13),r[15]^=i(r[11]+r[7],18),r[1]^=i(r[0]+r[3],7),r[2]^=i(r[1]+r[0],9),r[3]^=i(r[2]+r[1],13),r[0]^=i(r[3]+r[2],18),r[6]^=i(r[5]+r[4],7),r[7]^=i(r[6]+r[5],9),r[4]^=i(r[7]+r[6],13),r[5]^=i(r[4]+r[7],18),r[11]^=i(r[10]+r[9],7),r[8]^=i(r[11]+r[10],9),r[9]^=i(r[8]+r[11],13),r[10]^=i(r[9]+r[8],18),r[12]^=i(r[15]+r[14],7),r[13]^=i(r[12]+r[15],9),r[14]^=i(r[13]+r[12],13),r[15]^=i(r[14]+r[13],18);for(n=0;16>n;n++)t[n]=r[n]+t[n]},a.misc.scrypt.blockMix=function(t){for(var e=t.slice(-16),i=[],r=t.length/16,n=a.misc.scrypt,o=0;o<r;o++)n.blockxor(t,16*o,e,0,16),n.salsa20Core(e,8),0==(1&o)?n.blockcopy(e,0,i,8*o):n.blockcopy(e,0,i,8*(o^1+r));return i},a.misc.scrypt.ROMix=function(t,e){for(var i=t.slice(0),r=[],n=a.misc.scrypt,o=0;o<e;o++)r.push(i.slice(0)),i=n.blockMix(i);for(o=0;o<e;o++)n.blockxor(r[i[i.length-16]&e-1],0,i,0),i=n.blockMix(i);return i},a.misc.scrypt.reverse=function(t){for(var e in t){var i=(i=(i=(i=255&t[e])<<8|t[e]>>>8&255)<<8|t[e]>>>16&255)<<8|t[e]>>>24&255;t[e]=i}},a.misc.scrypt.blockcopy=function(t,e,i,r,n){var a;for(n=n||t.length-e,a=0;a<n;a++)i[r+a]=0|t[e+a]},a.misc.scrypt.blockxor=function(t,e,i,r,n){var a;for(n=n||t.length-e,a=0;a<n;a++)i[r+a]=i[r+a]^t[e+a]|0},a.prng=function(t){this.s=[new a.hash.sha256],this.K=[0],this.da=0,this.X={},this.ca=0,this.ia={},this.qa=this.B=this.L=this.Aa=0,this.i=[0,0,0,0,0,0,0,0],this.F=[0,0,0,0],this.aa=void 0,this.ba=t,this.V=!1,this.$={progress:{},seeded:{}},this.O=this.za=0,this.Y=1,this.Z=2,this.va=65536,this.fa=[0,48,64,96,128,192,256,384,512,768,1024],this.wa=3e4,this.ua=80},a.prng.prototype={randomWords:function(t,e){var i,r,n=[];if((i=this.isReady(e))===this.O)throw new a.exception.notReady("generator isn't seeded");if(i&this.Z){i=!(i&this.Y),r=[];var o,s=0;for(this.qa=r[0]=(new Date).valueOf()+this.wa,o=0;16>o;o++)r.push(4294967296*Math.random()|0);for(o=0;o<this.s.length&&(r=r.concat(this.s[o].finalize()),s+=this.K[o],this.K[o]=0,i||!(this.da&1<<o));o++);for(this.da>=1<<this.s.length&&(this.s.push(new a.hash.sha256),this.K.push(0)),this.B-=s,s>this.L&&(this.L=s),this.da++,this.i=a.hash.sha256.hash(this.i.concat(r)),this.aa=new a.cipher.aes(this.i),i=0;4>i&&(this.F[i]=this.F[i]+1|0,!this.F[i]);i++);}for(i=0;i<t;i+=4)0===(i+1)%this.va&&h(this),r=f(this),n.push(r[0],r[1],r[2],r[3]);return h(this),n.slice(0,t)},setDefaultParanoia:function(t,e){if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e)throw new a.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.ba=t},addEntropy:function(t,e,i){i=i||"user";var r,o,c=(new Date).valueOf(),h=this.X[i],f=this.isReady(),u=0;switch(void 0===(r=this.ia[i])&&(r=this.ia[i]=this.Aa++),void 0===h&&(h=this.X[i]=0),this.X[i]=(this.X[i]+1)%this.s.length,n(t)){case"number":void 0===e&&(e=1),this.s[h].update([r,this.ca++,1,e,c,1,0|t]);break;case"object":if("[object Uint32Array]"===(i=Object.prototype.toString.call(t))){for(o=[],i=0;i<t.length;i++)o.push(t[i]);t=o}else for("[object Array]"!==i&&(u=1),i=0;i<t.length&&!u;i++)"number"!==typeof t[i]&&(u=1);if(!u){if(void 0===e)for(i=e=0;i<t.length;i++)for(o=t[i];0<o;)e++,o>>>=1;this.s[h].update([r,this.ca++,2,e,c,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this.s[h].update([r,this.ca++,3,e,c,t.length]),this.s[h].update(t);break;default:u=1}if(u)throw new a.exception.bug("random: addEntropy only supports number, array of numbers or string");this.K[h]+=e,this.B+=e,f===this.O&&(this.isReady()!==this.O&&s("seeded",Math.max(this.L,this.B)),s("progress",this.getProgress()))},isReady:function(t){return t=this.fa[void 0!==t?t:this.ba],this.L&&this.L>=t?this.K[0]>this.ua&&(new Date).valueOf()>this.qa?this.Z|this.Y:this.Y:this.B>=t?this.Z|this.O:this.O},getProgress:function(t){return t=this.fa[t||this.ba],this.L>=t||this.B>t?1:this.B/t},startCollectors:function(){if(!this.V){if(this.j={loadTimeCollector:u(this,this.Ia),mouseCollector:u(this,this.Ja),keyboardCollector:u(this,this.Ga),accelerometerCollector:u(this,this.xa),touchCollector:u(this,this.La)},window.addEventListener)window.addEventListener("load",this.j.loadTimeCollector,!1),window.addEventListener("mousemove",this.j.mouseCollector,!1),window.addEventListener("keypress",this.j.keyboardCollector,!1),window.addEventListener("devicemotion",this.j.accelerometerCollector,!1),window.addEventListener("touchmove",this.j.touchCollector,!1);else{if(!document.attachEvent)throw new a.exception.bug("can't attach event");document.attachEvent("onload",this.j.loadTimeCollector),document.attachEvent("onmousemove",this.j.mouseCollector),document.attachEvent("keypress",this.j.keyboardCollector)}this.V=!0}},stopCollectors:function(){this.V&&(window.removeEventListener?(window.removeEventListener("load",this.j.loadTimeCollector,!1),window.removeEventListener("mousemove",this.j.mouseCollector,!1),window.removeEventListener("keypress",this.j.keyboardCollector,!1),window.removeEventListener("devicemotion",this.j.accelerometerCollector,!1),window.removeEventListener("touchmove",this.j.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.j.loadTimeCollector),document.detachEvent("onmousemove",this.j.mouseCollector),document.detachEvent("keypress",this.j.keyboardCollector)),this.V=!1)},addEventListener:function(t,e){this.$[t][this.za++]=e},removeEventListener:function(t,e){var i,r,n=this.$[t],a=[];for(r in n)n.hasOwnProperty(r)&&n[r]===e&&a.push(r);for(i=0;i<a.length;i++)delete n[r=a[i]]},Ga:function(){c(this,1)},Ja:function(t){var e,i;try{e=t.x||t.clientX||t.offsetX||0,i=t.y||t.clientY||t.offsetY||0}catch(t){i=e=0}0!=e&&0!=i&&this.addEntropy([e,i],2,"mouse"),c(this,0)},La:function(t){t=t.touches[0]||t.changedTouches[0],this.addEntropy([t.pageX||t.clientX,t.pageY||t.clientY],1,"touch"),c(this,0)},Ia:function(){c(this,2)},xa:function(t){if(t=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z,window.orientation){var e=window.orientation;"number"===typeof e&&this.addEntropy(e,1,"accelerometer")}t&&this.addEntropy(t,2,"accelerometer"),c(this,0)}},a.random=new a.prng(6);t:try{var l,d,b,p;if(p=t.exports){var m;try{m=i(64)}catch(F){m=null}p=d=m}if(p&&d.randomBytes)l=d.randomBytes(128),l=new Uint32Array(new Uint8Array(l).buffer),a.random.addEntropy(l,1024,"crypto['randomBytes']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){if(b=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(b);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break t;window.msCrypto.getRandomValues(b)}a.random.addEntropy(b,1024,"crypto['getRandomValues']")}}catch(F){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(F))}a.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},Ca:function(t,e,i,r){i=i||{},r=r||{};var n,o=a.json,s=o.C({iv:a.random.randomWords(4,0)},o.defaults);if(o.C(s,i),i=s.adata,"string"===typeof s.salt&&(s.salt=a.codec.base64.toBits(s.salt)),"string"===typeof s.iv&&(s.iv=a.codec.base64.toBits(s.iv)),!a.mode[s.mode]||!a.cipher[s.cipher]||"string"===typeof t&&100>=s.iter||64!==s.ts&&96!==s.ts&&128!==s.ts||128!==s.ks&&192!==s.ks&&256!==s.ks||2>s.iv.length||4<s.iv.length)throw new a.exception.invalid("json encrypt: invalid parameters");return"string"===typeof t?(t=(n=a.misc.cachedPbkdf2(t,s)).key.slice(0,s.ks/32),s.salt=n.salt):a.ecc&&t instanceof a.ecc.elGamal.publicKey&&(n=t.kem(),s.kemtag=n.tag,t=n.key.slice(0,s.ks/32)),"string"===typeof e&&(e=a.codec.utf8String.toBits(e)),"string"===typeof i&&(s.adata=i=a.codec.utf8String.toBits(i)),n=new a.cipher[s.cipher](t),o.C(r,s),r.key=t,s.ct="ccm"===s.mode&&a.arrayBuffer&&a.arrayBuffer.ccm&&e instanceof ArrayBuffer?a.arrayBuffer.ccm.encrypt(n,e,s.iv,i,s.ts):a.mode[s.mode].encrypt(n,e,s.iv,i,s.ts),s},encrypt:function(t,e,i,r){var n=a.json,o=n.Ca.apply(n,arguments);return n.encode(o)},Ba:function(t,e,i,r){i=i||{},r=r||{};var n,o,s=a.json;if(n=(e=s.C(s.C(s.C({},s.defaults),e),i,!0)).adata,"string"===typeof e.salt&&(e.salt=a.codec.base64.toBits(e.salt)),"string"===typeof e.iv&&(e.iv=a.codec.base64.toBits(e.iv)),!a.mode[e.mode]||!a.cipher[e.cipher]||"string"===typeof t&&100>=e.iter||64!==e.ts&&96!==e.ts&&128!==e.ts||128!==e.ks&&192!==e.ks&&256!==e.ks||!e.iv||2>e.iv.length||4<e.iv.length)throw new a.exception.invalid("json decrypt: invalid parameters");return"string"===typeof t?(t=(o=a.misc.cachedPbkdf2(t,e)).key.slice(0,e.ks/32),e.salt=o.salt):a.ecc&&t instanceof a.ecc.elGamal.secretKey&&(t=t.unkem(a.codec.base64.toBits(e.kemtag)).slice(0,e.ks/32)),"string"===typeof n&&(n=a.codec.utf8String.toBits(n)),o=new a.cipher[e.cipher](t),n="ccm"===e.mode&&a.arrayBuffer&&a.arrayBuffer.ccm&&e.ct instanceof ArrayBuffer?a.arrayBuffer.ccm.decrypt(o,e.ct,e.iv,e.tag,n,e.ts):a.mode[e.mode].decrypt(o,e.ct,e.iv,n,e.ts),s.C(r,e),r.key=t,1===i.raw?n:a.codec.utf8String.fromBits(n)},decrypt:function(t,e,i,r){var n=a.json;return n.Ba(t,n.decode(e),i,r)},encode:function(t){var e,i="{",r="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new a.exception.invalid("json encode: invalid property name");switch(i+=r+'"'+e+'":',r=",",n(t[e])){case"number":case"boolean":i+=t[e];break;case"string":i+='"'+escape(t[e])+'"';break;case"object":i+='"'+a.codec.base64.fromBits(t[e],0)+'"';break;default:throw new a.exception.bug("json encode: unsupported type")}}return i+"}"},decode:function(t){if(!(t=t.replace(/\s/g,"")).match(/^\{.*\}$/))throw new a.exception.invalid("json decode: this isn't json!");t=t.replace(/^\{|\}$/g,"").split(/,/);var e,i,r={};for(e=0;e<t.length;e++){if(!(i=t[e].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new a.exception.invalid("json decode: this isn't json!");null!=i[3]?r[i[2]]=parseInt(i[3],10):null!=i[4]?r[i[2]]=i[2].match(/^(ct|adata|salt|iv)$/)?a.codec.base64.toBits(i[4]):unescape(i[4]):null!=i[5]&&(r[i[2]]="true"===i[5])}return r},C:function(t,e,i){if(void 0===t&&(t={}),void 0===e)return t;for(var r in e)if(e.hasOwnProperty(r)){if(i&&void 0!==t[r]&&t[r]!==e[r])throw new a.exception.invalid("required parameter overridden");t[r]=e[r]}return t},Na:function(t,e){var i,r={};for(i in t)t.hasOwnProperty(i)&&t[i]!==e[i]&&(r[i]=t[i]);return r},Ma:function(t,e){var i,r={};for(i=0;i<e.length;i++)void 0!==t[e[i]]&&(r[e[i]]=t[e[i]]);return r}},a.encrypt=a.json.encrypt,a.decrypt=a.json.decrypt,a.misc.Ka={},a.misc.cachedPbkdf2=function(t,e){var i,r=a.misc.Ka;return i=(e=e||{}).iter||1e3,(i=(r=r[t]=r[t]||{})[i]=r[i]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):a.random.randomWords(2,0)})[r=void 0===e.salt?i.firstSalt:e.salt]=i[r]||a.misc.pbkdf2(t,r,e.iter),{key:i[r].slice(0),salt:r.slice(0)}},a.bn=function(t){this.initWith(t)},a.bn.prototype={radix:24,maxMul:8,o:a.bn,copy:function(){return new this.o(this)},initWith:function(t){var e,i=0;switch(n(t)){case"object":this.limbs=t.limbs.slice(0);break;case"number":this.limbs=[t],this.normalize();break;case"string":for(t=t.replace(/^0x/,""),this.limbs=[],e=this.radix/4,i=0;i<t.length;i+=e)this.limbs.push(parseInt(t.substring(Math.max(t.length-i-e,0),t.length-i),16));break;default:this.limbs=[0]}return this},equals:function(t){"number"===typeof t&&(t=new this.o(t));var e,i=0;for(this.fullReduce(),t.fullReduce(),e=0;e<this.limbs.length||e<t.limbs.length;e++)i|=this.getLimb(e)^t.getLimb(e);return 0===i},getLimb:function(t){return t>=this.limbs.length?0:this.limbs[t]},greaterEquals:function(t){"number"===typeof t&&(t=new this.o(t));var e,i,r,n=0,a=0;for(e=Math.max(this.limbs.length,t.limbs.length)-1;0<=e;e--)n|=(i=this.getLimb(e))-(r=t.getLimb(e))&~(a|=r-i&~n);return(a|~n)>>>31},toString:function(){this.fullReduce();var t,e,i="",r=this.limbs;for(t=0;t<this.limbs.length;t++){for(e=r[t].toString(16);t<this.limbs.length-1&&6>e.length;)e="0"+e;i=e+i}return"0x"+i},addM:function(t){"object"!==n(t)&&(t=new this.o(t));var e=this.limbs,i=t.limbs;for(t=e.length;t<i.length;t++)e[t]=0;for(t=0;t<i.length;t++)e[t]+=i[t];return this},doubleM:function(){var t,e,i=0,r=this.radix,n=this.radixMask,a=this.limbs;for(t=0;t<a.length;t++)e=(e=a[t])+e+i,a[t]=e&n,i=e>>r;return i&&a.push(i),this},halveM:function(){var t,e,i=0,r=this.radix,n=this.limbs;for(t=n.length-1;0<=t;t--)e=n[t],n[t]=e+i>>1,i=(1&e)<<r;return n[n.length-1]||n.pop(),this},subM:function(t){"object"!==n(t)&&(t=new this.o(t));var e=this.limbs,i=t.limbs;for(t=e.length;t<i.length;t++)e[t]=0;for(t=0;t<i.length;t++)e[t]-=i[t];return this},mod:function(t){var e=!this.greaterEquals(new a.bn(0));t=new a.bn(t).normalize();var i=new a.bn(this).normalize(),r=0;for(e&&(i=new a.bn(0).subM(i).normalize());i.greaterEquals(t);r++)t.doubleM();for(e&&(i=t.sub(i).normalize());0<r;r--)t.halveM(),i.greaterEquals(t)&&i.subM(t).normalize();return i.trim()},inverseMod:function(t){var e,i=new a.bn(1),r=new a.bn(0),n=new a.bn(this),o=new a.bn(t),s=1;if(!(1&t.limbs[0]))throw new a.exception.invalid("inverseMod: p must be odd");do{for(1&n.limbs[0]&&(n.greaterEquals(o)||(e=n,n=o,o=e,e=i,i=r,r=e),n.subM(o),n.normalize(),i.greaterEquals(r)||i.addM(t),i.subM(r)),n.halveM(),1&i.limbs[0]&&i.addM(t),i.normalize(),i.halveM(),e=s=0;e<n.limbs.length;e++)s|=n.limbs[e]}while(s);if(!o.equals(1))throw new a.exception.invalid("inverseMod: p and x must be relatively prime");return r},add:function(t){return this.copy().addM(t)},sub:function(t){return this.copy().subM(t)},mul:function(t){"number"===typeof t?t=new this.o(t):t.normalize(),this.normalize();var e,i,r=this.limbs,n=t.limbs,a=r.length,o=n.length,s=new this.o,c=s.limbs,h=this.maxMul;for(e=0;e<this.limbs.length+t.limbs.length+1;e++)c[e]=0;for(e=0;e<a;e++){for(i=r[e],t=0;t<o;t++)c[e+t]+=i*n[t];--h||(h=this.maxMul,s.cnormalize())}return s.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(t){t=new a.bn(t).normalize().trim().limbs;var e,i,r=new this.o(1),n=this;for(e=0;e<t.length;e++)for(i=0;i<this.radix&&(t[e]&1<<i&&(r=r.mul(n)),e!=t.length-1||0!=t[e]>>i+1);i++)n=n.square();return r},mulmod:function(t,e){return this.mod(e).mul(t.mod(e)).mod(e)},powermod:function(t,e){if((t=new a.bn(t),1==(1&(e=new a.bn(e)).limbs[0]))&&0!=(s=this.montpowermod(t,e)))return s;for(var i,r=t.normalize().trim().limbs,n=new this.o(1),o=this,s=0;s<r.length;s++)for(i=0;i<this.radix&&(r[s]&1<<i&&(n=n.mulmod(o,e)),s!=r.length-1||0!=r[s]>>i+1);i++)o=o.mulmod(o,e);return n},montpowermod:function(t,e){function i(t,e){var i=e%t.radix;return(t.limbs[Math.floor(e/t.radix)]&1<<i)>>i}function r(t,i){var r,n,a=(1<<c+1)-1;for((n=(r=t.mul(i)).mul(b)).limbs=n.limbs.slice(0,s.limbs.length),n.limbs.length==s.limbs.length&&(n.limbs[s.limbs.length-1]&=a),n=n.mul(e),(n=r.add(n).normalize().trim()).limbs=n.limbs.slice(s.limbs.length-1),r=0;r<n.limbs.length;r++)0<r&&(n.limbs[r-1]|=(n.limbs[r]&a)<<f-c-1),n.limbs[r]>>=c+1;return n.greaterEquals(e)&&n.subM(e),n}t=new a.bn(t).normalize().trim(),e=new a.bn(e);var n,o,s,c,h,f=this.radix,u=new this.o(1);for(n=this.copy(),h=t.bitLength(),s=new a.bn({limbs:e.copy().normalize().trim().limbs.map((function(){return 0}))}),c=this.radix;0<c;c--)if(1==(e.limbs[e.limbs.length-1]>>c&1)){s.limbs[s.limbs.length-1]=1<<c;break}if(0==h)return this;h=18>h?1:48>h?3:144>h?4:768>h?5:6;var l=s.copy(),d=e.copy();o=new a.bn(1);for(var b=new a.bn(0),p=s.copy();p.greaterEquals(1);)p.halveM(),0==(1&o.limbs[0])?(o.halveM(),b.halveM()):(o.addM(d),o.halveM(),b.halveM(),b.addM(l));if(o=o.normalize(),b=b.normalize(),l.doubleM(),d=l.mulmod(l,e),!l.mul(o).sub(e.mul(b)).equals(1))return!1;for(n=r(n,d),u=r(u,d),o=(1<<h-1)-1,(l={})[1]=n.copy(),l[2]=r(n,n),n=1;n<=o;n++)l[2*n+1]=r(l[2*n-1],l[2]);for(n=t.bitLength()-1;0<=n;)if(0==i(t,n))u=r(u,u),--n;else{for(d=n-h+1;0==i(t,d);)d++;for(p=0,o=d;o<=n;o++)p+=i(t,o)<<o-d,u=r(u,u);u=r(u,l[p]),n=d-1}return r(u,1)},trim:function(){var t,e=this.limbs;do{t=e.pop()}while(e.length&&0===t);return e.push(t),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var t,e=0,i=this.placeVal,r=this.ipv,n=this.limbs,a=n.length,o=this.radixMask;for(t=0;t<a||0!==e&&-1!==e;t++)e=((e=(n[t]||0)+e)-(n[t]=e&o))*r;return-1===e&&(n[t-1]-=i),this.trim(),this},cnormalize:function(){var t,e=0,i=this.ipv,r=this.limbs,n=r.length,a=this.radixMask;for(t=0;t<n-1;t++)e=((e=r[t]+e)-(r[t]=e&a))*i;return r[t]+=e,this},toBits:function(t){this.fullReduce(),t=t||this.exponent||this.bitLength();var e=Math.floor((t-1)/24),i=a.bitArray,r=[i.partial((t+7&-8)%this.radix||this.radix,this.getLimb(e))];for(e--;0<=e;e--)r=i.concat(r,[i.partial(Math.min(this.radix,t),this.getLimb(e))]),t-=this.radix;return r},bitLength:function(){this.fullReduce();for(var t=this.radix*(this.limbs.length-1),e=this.limbs[this.limbs.length-1];e;e>>>=1)t++;return t+7&-8}},a.bn.fromBits=function(t){var e=new this,i=[],r=a.bitArray,n=this.prototype,o=Math.min(this.bitLength||4294967296,r.bitLength(t)),s=o%n.radix||n.radix;for(i[0]=r.extract(t,0,s);s<o;s+=n.radix)i.unshift(r.extract(t,s,n.radix));return e.limbs=i,e},a.bn.prototype.ipv=1/(a.bn.prototype.placeVal=Math.pow(2,a.bn.prototype.radix)),a.bn.prototype.radixMask=(1<<a.bn.prototype.radix)-1,a.bn.pseudoMersennePrime=function(t,e){function i(t){this.initWith(t)}var r,n,o,s=i.prototype=new a.bn;for(o=s.modOffset=Math.ceil(n=t/s.radix),s.exponent=t,s.offset=[],s.factor=[],s.minOffset=o,s.fullMask=0,s.fullOffset=[],s.fullFactor=[],s.modulus=i.modulus=new a.bn(Math.pow(2,t)),s.fullMask=0|-Math.pow(2,t%s.radix),r=0;r<e.length;r++)s.offset[r]=Math.floor(e[r][0]/s.radix-n),s.fullOffset[r]=Math.floor(e[r][0]/s.radix)-o+1,s.factor[r]=e[r][1]*Math.pow(.5,t-e[r][0]+s.offset[r]*s.radix),s.fullFactor[r]=e[r][1]*Math.pow(.5,t-e[r][0]+s.fullOffset[r]*s.radix),s.modulus.addM(new a.bn(Math.pow(2,e[r][0])*e[r][1])),s.minOffset=Math.min(s.minOffset,-s.offset[r]);return s.o=i,s.modulus.cnormalize(),s.reduce=function(){var t,e,i,r,n=this.modOffset,a=this.limbs,o=this.offset,s=this.offset.length,c=this.factor;for(t=this.minOffset;a.length>n;){for(i=a.pop(),r=a.length,e=0;e<s;e++)a[r+o[e]]-=c[e]*i;--t||(a.push(0),this.cnormalize(),t=this.minOffset)}return this.cnormalize(),this},s.sa=-1===s.fullMask?s.reduce:function(){var t,e,i=this.limbs,r=i.length-1;if(this.reduce(),r===this.modOffset-1){for(e=i[r]&this.fullMask,i[r]-=e,t=0;t<this.fullOffset.length;t++)i[r+this.fullOffset[t]]-=this.fullFactor[t]*e;this.normalize()}},s.fullReduce=function(){var t,e;for(this.sa(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this.sa(),e=this.limbs.length;e<this.modOffset;e++)this.limbs[e]=0;for(t=this.greaterEquals(this.modulus),e=0;e<this.limbs.length;e++)this.limbs[e]-=this.modulus.limbs[e]*t;return this.cnormalize(),this},s.inverse=function(){return this.power(this.modulus.sub(2))},i.fromBits=a.bn.fromBits,i};var F,B=a.bn.pseudoMersennePrime;a.bn.prime={p127:B(127,[[0,-1]]),p25519:B(255,[[0,-19]]),p192k:B(192,[[32,-1],[12,-1],[8,-1],[7,-1],[6,-1],[3,-1],[0,-1]]),p224k:B(224,[[32,-1],[12,-1],[11,-1],[9,-1],[7,-1],[4,-1],[1,-1],[0,-1]]),p256k:B(256,[[32,-1],[9,-1],[8,-1],[7,-1],[6,-1],[4,-1],[0,-1]]),p192:B(192,[[0,-1],[64,-1]]),p224:B(224,[[0,1],[96,-1]]),p256:B(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:B(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:B(521,[[0,-1]])},a.bn.random=function(t,e){"object"!==n(t)&&(t=new a.bn(t));for(var i,r,o=t.limbs.length,s=t.limbs[o-1]+1,c=new a.bn;;){do{0>(i=a.random.randomWords(o,e))[o-1]&&(i[o-1]+=4294967296)}while(Math.floor(i[o-1]/s)===Math.floor(4294967296/s));for(i[o-1]%=s,r=0;r<o-1;r++)i[r]&=t.radixMask;if(c.limbs=i,!c.greaterEquals(t))return c}},a.ecc={},a.ecc.point=function(t,e,i){void 0===e?this.isIdentity=!0:(e instanceof a.bn&&(e=new t.field(e)),i instanceof a.bn&&(i=new t.field(i)),this.x=e,this.y=i,this.isIdentity=!1),this.curve=t},a.ecc.point.prototype={toJac:function(){return new a.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(t){return this.toJac().mult(t,this).toAffine()},mult2:function(t,e,i){return this.toJac().mult2(t,this,e,i).toAffine()},multiples:function(){var t,e,i;if(void 0===this.pa)for(i=this.toJac().doubl(),t=this.pa=[new a.ecc.point(this.curve),this,i.toAffine()],e=3;16>e;e++)i=i.add(this),t.push(i.toAffine());return this.pa},negate:function(){var t=new this.curve.field(0).sub(this.y).normalize().reduce();return new a.ecc.point(this.curve,this.x,t)},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){return a.bitArray.concat(this.x.toBits(),this.y.toBits())}},a.ecc.pointJac=function(t,e,i,r){void 0===e?this.isIdentity=!0:(this.x=e,this.y=i,this.z=r,this.isIdentity=!1),this.curve=t},a.ecc.pointJac.prototype={add:function(t){var e,i,r,n;if(this.curve!==t.curve)throw new a.exception.invalid("sjcl['ecc']['add'](): Points must be on the same curve to add them!");return this.isIdentity?t.toJac():t.isIdentity?this:(e=this.z.square(),(i=t.x.mul(e).subM(this.x)).equals(0)?this.y.equals(t.y.mul(e.mul(this.z)))?this.doubl():new a.ecc.pointJac(this.curve):(e=t.y.mul(e.mul(this.z)).subM(this.y),r=i.square(),t=e.square(),n=i.square().mul(i).addM(this.x.add(this.x).mul(r)),t=t.subM(n),e=this.x.mul(r).subM(t).mul(e),r=this.y.mul(i.square().mul(i)),e=e.subM(r),i=this.z.mul(i),new a.ecc.pointJac(this.curve,t,e,i)))},doubl:function(){if(this.isIdentity)return this;var t=(i=this.y.square()).mul(this.x.mul(4)),e=i.square().mul(8),i=this.z.square(),r=this.curve.a.toString()==new a.bn(-3).toString()?this.x.sub(i).mul(3).mul(this.x.add(i)):this.x.square().mul(3).add(i.square().mul(this.curve.a));i=r.square().subM(t).subM(t),t=t.sub(i).mul(r).subM(e),e=this.y.add(this.y).mul(this.z);return new a.ecc.pointJac(this.curve,i,t,e)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new a.ecc.point(this.curve);var t=this.z.inverse(),e=t.square();return new a.ecc.point(this.curve,this.x.mul(e).fullReduce(),this.y.mul(e.mul(t)).fullReduce())},mult:function(t,e){"number"===typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs);var i,r,n=new a.ecc.point(this.curve).toJac(),o=e.multiples();for(i=t.length-1;0<=i;i--)for(r=a.bn.prototype.radix-4;0<=r;r-=4)n=n.doubl().doubl().doubl().doubl().add(o[t[i]>>r&15]);return n},mult2:function(t,e,i,r){"number"===typeof t?t=[t]:void 0!==t.limbs&&(t=t.normalize().limbs),"number"===typeof i?i=[i]:void 0!==i.limbs&&(i=i.normalize().limbs);var n,o=new a.ecc.point(this.curve).toJac();e=e.multiples();var s,c,h=r.multiples();for(r=Math.max(t.length,i.length)-1;0<=r;r--)for(s=0|t[r],c=0|i[r],n=a.bn.prototype.radix-4;0<=n;n-=4)o=o.doubl().doubl().doubl().doubl().add(e[s>>n&15]).add(h[c>>n&15]);return o},negate:function(){return this.toAffine().negate().toJac()},isValid:function(){var t=(e=this.z.square()).square(),e=t.mul(e);return this.y.square().equals(this.curve.b.mul(e).add(this.x.mul(this.curve.a.mul(t).add(this.x.square()))))}},a.ecc.curve=function(t,e,i,r,n,o){this.field=t,this.r=new a.bn(e),this.a=new t(i),this.b=new t(r),this.G=new a.ecc.point(this,new t(n),new t(o))},a.ecc.curve.prototype.fromBits=function(t){var e=a.bitArray,i=this.field.prototype.exponent+7&-8;if(!(t=new a.ecc.point(this,this.field.fromBits(e.bitSlice(t,0,i)),this.field.fromBits(e.bitSlice(t,i,2*i)))).isValid())throw new a.exception.corrupt("not on the curve!");return t},a.ecc.curves={c192:new a.ecc.curve(a.bn.prime.p192,"0xffffffffffffffffffffffff99def836146bc9b1b4d22831",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new a.ecc.curve(a.bn.prime.p224,"0xffffffffffffffffffffffffffff16a2e0b8f03e13dd29455c5c2a3d",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new a.ecc.curve(a.bn.prime.p256,"0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new a.ecc.curve(a.bn.prime.p384,"0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),c521:new a.ecc.curve(a.bn.prime.p521,"0x1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409",-3,"0x051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","0xC6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","0x11839296A789A3BC0045C8A5FB42C7D1BD998F54449579B446817AFBD17273E662C97EE72995EF42640C550B9013FAD0761353C7086A272C24088BE94769FD16650"),k192:new a.ecc.curve(a.bn.prime.p192k,"0xfffffffffffffffffffffffe26f2fc170f69466a74defd8d",0,3,"0xdb4ff10ec057e9ae26b07d0280b7f4341da5d1b1eae06c7d","0x9b2f2f6d9c5628a7844163d015be86344082aa88d95e2f9d"),k224:new a.ecc.curve(a.bn.prime.p224k,"0x010000000000000000000000000001dce8d2ec6184caf0a971769fb1f7",0,5,"0xa1455b334df099df30fc28a169a467e9e47075a90f7e650eb6b7a45c","0x7e089fed7fba344282cafbd6f7e319f7c0b0bd59e2ca4bdb556d61a5"),k256:new a.ecc.curve(a.bn.prime.p256k,"0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",0,7,"0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},a.ecc.curveName=function(t){for(var e in a.ecc.curves)if(a.ecc.curves.hasOwnProperty(e)&&a.ecc.curves[e]===t)return e;throw new a.exception.invalid("no such curve")},a.ecc.deserialize=function(t){if(!t||!t.curve||!a.ecc.curves[t.curve])throw new a.exception.invalid("invalid serialization");if(-1===["elGamal","ecdsa"].indexOf(t.type))throw new a.exception.invalid("invalid type");var e=a.ecc.curves[t.curve];if(t.secretKey){if(!t.exponent)throw new a.exception.invalid("invalid exponent");var i=new a.bn(t.exponent);return new a.ecc[t.type].secretKey(e,i)}if(!t.point)throw new a.exception.invalid("invalid point");return i=e.fromBits(a.codec.hex.toBits(t.point)),new a.ecc[t.type].publicKey(e,i)},a.ecc.basicKey={publicKey:function(t,e){this.w=t,this.I=t.r.bitLength(),this.H=e instanceof Array?t.fromBits(e):e,this.serialize=function(){var e=a.ecc.curveName(t);return{type:this.getType(),secretKey:!1,point:a.codec.hex.fromBits(this.H.toBits()),curve:e}},this.get=function(){var t=this.H.toBits(),e=a.bitArray.bitLength(t);return{x:a.bitArray.bitSlice(t,0,e/2),y:t=a.bitArray.bitSlice(t,e/2)}}},secretKey:function(t,e){this.w=t,this.I=t.r.bitLength(),this.S=e,this.serialize=function(){var e=this.get(),i=a.ecc.curveName(t);return{type:this.getType(),secretKey:!0,exponent:a.codec.hex.fromBits(e),curve:i}},this.get=function(){return this.S.toBits()}}},a.ecc.basicKey.generateKeys=function(t){return function(e,i,r){if("number"===typeof(e=e||256)&&void 0===(e=a.ecc.curves["c"+e]))throw new a.exception.invalid("no such curve");return r=r||a.bn.random(e.r,i),i=e.G.mult(r),{pub:new a.ecc[t].publicKey(e,i),sec:new a.ecc[t].secretKey(e,r)}}},a.ecc.elGamal={generateKeys:a.ecc.basicKey.generateKeys("elGamal"),publicKey:function(t,e){a.ecc.basicKey.publicKey.apply(this,arguments)},secretKey:function(t,e){a.ecc.basicKey.secretKey.apply(this,arguments)}},a.ecc.elGamal.publicKey.prototype={kem:function(t){t=a.bn.random(this.w.r,t);var e=this.w.G.mult(t).toBits();return{key:a.hash.sha256.hash(this.H.mult(t).toBits()),tag:e}},getType:function(){return"elGamal"}},a.ecc.elGamal.secretKey.prototype={unkem:function(t){return a.hash.sha256.hash(this.w.fromBits(t).mult(this.S).toBits())},dh:function(t){return a.hash.sha256.hash(t.H.mult(this.S).toBits())},dhJavaEc:function(t){return t.H.mult(this.S).x.toBits()},getType:function(){return"elGamal"}},a.ecc.ecdsa={generateKeys:a.ecc.basicKey.generateKeys("ecdsa")},a.ecc.ecdsa.publicKey=function(t,e){a.ecc.basicKey.publicKey.apply(this,arguments)},a.ecc.ecdsa.publicKey.prototype={verify:function(t,e,i){a.bitArray.bitLength(t)>this.I&&(t=a.bitArray.clamp(t,this.I));var r=a.bitArray,n=this.w.r,o=this.I,s=a.bn.fromBits(r.bitSlice(e,0,o)),c=(r=a.bn.fromBits(r.bitSlice(e,o,2*o)),i?r:r.inverseMod(n));o=a.bn.fromBits(t).mul(c).mod(n),c=s.mul(c).mod(n),o=this.w.G.mult2(o,c,this.H).x;if(s.equals(0)||r.equals(0)||s.greaterEquals(n)||r.greaterEquals(n)||!o.equals(s)){if(void 0===i)return this.verify(t,e,!0);throw new a.exception.corrupt("signature didn't check out")}return!0},getType:function(){return"ecdsa"}},a.ecc.ecdsa.secretKey=function(t,e){a.ecc.basicKey.secretKey.apply(this,arguments)},a.ecc.ecdsa.secretKey.prototype={sign:function(t,e,i,r){a.bitArray.bitLength(t)>this.I&&(t=a.bitArray.clamp(t,this.I));var n=this.w.r,o=n.bitLength();return r=r||a.bn.random(n.sub(1),e).add(1),e=this.w.G.mult(r).x.mod(n),t=a.bn.fromBits(t).add(e.mul(this.S)),i=i?t.inverseMod(n).mul(r).mod(n):t.mul(r.inverseMod(n)).mod(n),a.bitArray.concat(e.toBits(o),i.toBits(o))},getType:function(){return"ecdsa"}},a.keyexchange.srp={makeVerifier:function(t,e,i,r){return t=a.keyexchange.srp.makeX(t,e,i),t=a.bn.fromBits(t),r.g.powermod(t,r.N)},makeX:function(t,e,i){return t=a.hash.sha1.hash(t+":"+e),a.hash.sha1.hash(a.bitArray.concat(i,t))},knownGroup:function(t){return"string"!==typeof t&&(t=t.toString()),a.keyexchange.srp.ja||a.keyexchange.srp.Ea(),a.keyexchange.srp.na[t]},ja:!1,Ea:function(){var t,e;for(t=0;t<a.keyexchange.srp.ma.length;t++)e=a.keyexchange.srp.ma[t].toString(),(e=a.keyexchange.srp.na[e]).N=new a.bn(e.N),e.g=new a.bn(e.g);a.keyexchange.srp.ja=!0},ma:[1024,1536,2048,3072,4096,6144,8192],na:{1024:{N:"EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE48E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B297BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9AFD5138FE8376435B9FC61D2FC0EB06E3",g:2},1536:{N:"9DEF3CAFB939277AB1F12A8617A47BBBDBA51DF499AC4C80BEEEA9614B19CC4D5F4F5F556E27CBDE51C6A94BE4607A291558903BA0D0F84380B655BB9A22E8DCDF028A7CEC67F0D08134B1C8B97989149B609E0BE3BAB63D47548381DBC5B1FC764E3F4B53DD9DA1158BFD3E2B9C8CF56EDF019539349627DB2FD53D24B7C48665772E437D6C7F8CE442734AF7CCB7AE837C264AE3A9BEB87F8A2FE9B8B5292E5A021FFF5E91479E8CE7A28C2442C6F315180F93499A234DCF76E3FED135F9BB",g:2},2048:{N:"AC6BDB41324A9A9BF166DE5E1389582FAF72B6651987EE07FC3192943DB56050A37329CBB4A099ED8193E0757767A13DD52312AB4B03310DCD7F48A9DA04FD50E8083969EDB767B0CF6095179A163AB3661A05FBD5FAAAE82918A9962F0B93B855F97993EC975EEAA80D740ADBF4FF747359D041D5C33EA71D281E446B14773BCA97B43A23FB801676BD207A436C6481F1D2B9078717461A5B9D32E688F87748544523B524B0D57D5EA77A2775D2ECFA032CFBDBF52FB3786160279004E57AE6AF874E7303CE53299CCC041C7BC308D82A5698F3A8D0C38271AE35F8E9DBFBB694B5C803D89F7AE435DE236D525F54759B65E372FCD68EF20FA7111F9E4AFF73",g:2},3072:{N:"FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",g:5},4096:{N:"FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D788719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8DBBBC2DB04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2233BA186515BE7ED1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA993B4EA988D8FDDC186FFB7DC90A6C08F4DF435C934063199FFFFFFFFFFFFFFFF",g:5},6144:{N:"FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D788719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8DBBBC2DB04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2233BA186515BE7ED1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA993B4EA988D8FDDC186FFB7DC90A6C08F4DF435C93402849236C3FAB4D27C7026C1D4DCB2602646DEC9751E763DBA37BDF8FF9406AD9E530EE5DB382F413001AEB06A53ED9027D831179727B0865A8918DA3EDBEBCF9B14ED44CE6CBACED4BB1BDB7F1447E6CC254B332051512BD7AF426FB8F401378CD2BF5983CA01C64B92ECF032EA15D1721D03F482D7CE6E74FEF6D55E702F46980C82B5A84031900B1C9E59E7C97FBEC7E8F323A97A7E36CC88BE0F1D45B7FF585AC54BD407B22B4154AACC8F6D7EBF48E1D814CC5ED20F8037E0A79715EEF29BE32806A1D58BB7C5DA76F550AA3D8A1FBFF0EB19CCB1A313D55CDA56C9EC2EF29632387FE8D76E3C0468043E8F663F4860EE12BF2D5B0B7474D6E694F91E6DCC4024FFFFFFFFFFFFFFFF",g:5},8192:{N:"FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D788719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8DBBBC2DB04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2233BA186515BE7ED1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA993B4EA988D8FDDC186FFB7DC90A6C08F4DF435C93402849236C3FAB4D27C7026C1D4DCB2602646DEC9751E763DBA37BDF8FF9406AD9E530EE5DB382F413001AEB06A53ED9027D831179727B0865A8918DA3EDBEBCF9B14ED44CE6CBACED4BB1BDB7F1447E6CC254B332051512BD7AF426FB8F401378CD2BF5983CA01C64B92ECF032EA15D1721D03F482D7CE6E74FEF6D55E702F46980C82B5A84031900B1C9E59E7C97FBEC7E8F323A97A7E36CC88BE0F1D45B7FF585AC54BD407B22B4154AACC8F6D7EBF48E1D814CC5ED20F8037E0A79715EEF29BE32806A1D58BB7C5DA76F550AA3D8A1FBFF0EB19CCB1A313D55CDA56C9EC2EF29632387FE8D76E3C0468043E8F663F4860EE12BF2D5B0B7474D6E694F91E6DBE115974A3926F12FEE5E438777CB6A932DF8CD8BEC4D073B931BA3BC832B68D9DD300741FA7BF8AFC47ED2576F6936BA424663AAB639C5AE4F5683423B4742BF1C978238F16CBE39D652DE3FDB8BEFC848AD922222E04A4037C0713EB57A81A23F0C73473FC646CEA306B4BCBC8862F8385DDFA9D4B7FA2C087E879683303ED5BDD3A062B3CF5B3A278A66D2A13F83F44F82DDF310EE074AB6A364597E899A0255DC164F31CC50846851DF9AB48195DED7EA1B1D510BD7EE74D73FAF36BC31ECFA268359046F4EB879F924009438B481C6CD7889A002ED5EE382BC9190DA6FC026E479558E4475677E9AA9E3050E2765694DFC81F56E880B96E7160C980DD98EDD3DFFFFFFFFFFFFFFFFF",g:19}}},a.arrayBuffer=a.arrayBuffer||{},"undefined"===typeof ArrayBuffer&&((F=this).ArrayBuffer=function(){},F.DataView=function(){}),a.arrayBuffer.ccm={mode:"ccm",defaults:{tlen:128},compat_encrypt:function(t,e,i,r,n){var o=a.codec.arrayBuffer.fromBits(e,!0,16);return e=a.bitArray.bitLength(e)/8,r=r||[],t=a.arrayBuffer.ccm.encrypt(t,o,i,r,n||64,e),i=a.codec.arrayBuffer.toBits(t.ciphertext_buffer),i=a.bitArray.clamp(i,8*e),a.bitArray.concat(i,t.tag)},compat_decrypt:function(t,e,i,r,n){n=n||64,r=r||[];var o=a.bitArray,s=o.bitLength(e),c=o.clamp(e,s-n);return e=o.bitSlice(e,s-n),c=a.codec.arrayBuffer.fromBits(c,!0,16),t=a.arrayBuffer.ccm.decrypt(t,c,i,e,r,n,(s-n)/8),a.bitArray.clamp(a.codec.arrayBuffer.toBits(t),s-n)},encrypt:function(t,e,i,r,n,o){var s,c=a.bitArray,h=c.bitLength(i)/8;for(r=r||[],n=n||a.arrayBuffer.ccm.defaults.tlen,o=o||e.byteLength,n=Math.ceil(n/8),s=2;4>s&&o>>>8*s;s++);return s<15-h&&(s=15-h),i=c.clamp(i,8*(15-s)),r=a.arrayBuffer.ccm.R(t,e,i,r,n,o,s),{ciphertext_buffer:e,tag:r=a.arrayBuffer.ccm.u(t,e,i,r,n,s)}},decrypt:function(t,e,i,r,n,o,s){var c,h=a.bitArray,f=h.bitLength(i)/8;for(n=n||[],o=o||a.arrayBuffer.ccm.defaults.tlen,s=s||e.byteLength,o=Math.ceil(o/8),c=2;4>c&&s>>>8*c;c++);if(c<15-f&&(c=15-f),i=h.clamp(i,8*(15-c)),r=a.arrayBuffer.ccm.u(t,e,i,r,o,c),t=a.arrayBuffer.ccm.R(t,e,i,n,o,s,c),!a.bitArray.equal(r,t))throw new a.exception.corrupt("ccm: tag doesn't match");return e},R:function(t,e,i,r,n,o,s){if(i=a.mode.ccm.oa(t,r,i,n,o,s),0!==e.byteLength){for(r=new DataView(e);o<e.byteLength;o++)r.setUint8(o,0);for(o=0;o<r.byteLength;o+=16)i[0]^=r.getUint32(o),i[1]^=r.getUint32(o+4),i[2]^=r.getUint32(o+8),i[3]^=r.getUint32(o+12),i=t.encrypt(i)}return a.bitArray.clamp(i,8*n)},u:function(t,e,i,r,n,o){var s,c,h,f,u;c=(s=a.bitArray).l;var l=e.byteLength/50,d=l;if(new DataView(new ArrayBuffer(16)),i=s.concat([s.partial(8,o-1)],i).concat([0,0,0]).slice(0,4),r=s.bitSlice(c(r,t.encrypt(i)),0,8*n),i[3]++,0===i[3]&&i[2]++,0!==e.byteLength)for(n=new DataView(e),u=0;u<n.byteLength;u+=16)u>l&&(a.mode.ccm.ha(u/e.byteLength),l+=d),f=t.encrypt(i),s=n.getUint32(u),c=n.getUint32(u+4),o=n.getUint32(u+8),h=n.getUint32(u+12),n.setUint32(u,s^f[0]),n.setUint32(u+4,c^f[1]),n.setUint32(u+8,o^f[2]),n.setUint32(u+12,h^f[3]),i[3]++,0===i[3]&&i[2]++;return r}},"undefined"===typeof ArrayBuffer&&function(t){t.ArrayBuffer=function(){},t.DataView=function(){}}(this),a.codec.arrayBuffer={fromBits:function(t,e,i){var r;if(e=void 0==e||e,i=i||8,0===t.length)return new ArrayBuffer(0);if(r=a.bitArray.bitLength(t)/8,0!==a.bitArray.bitLength(t)%8)throw new a.exception.invalid("Invalid bit size, must be divisble by 8 to fit in an arraybuffer correctly");for(e&&0!==r%i&&(r+=i-r%i),i=new DataView(new ArrayBuffer(4*t.length)),e=0;e<t.length;e++)i.setUint32(4*e,t[e]<<32);if((t=new DataView(new ArrayBuffer(r))).byteLength===i.byteLength)return i.buffer;for(r=i.byteLength<t.byteLength?i.byteLength:t.byteLength,e=0;e<r;e++)t.setUint8(e,i.getUint8(e));return t.buffer},toBits:function(t){var e,i,r,n=[];if(0===t.byteLength)return[];for(e=(i=new DataView(t)).byteLength-i.byteLength%4,t=0;t<e;t+=4)n.push(i.getUint32(t));if(0!=i.byteLength%4){r=new DataView(new ArrayBuffer(4)),t=0;for(var o=i.byteLength%4;t<o;t++)r.setUint8(t+4-o,i.getUint8(e+t));n.push(a.bitArray.partial(i.byteLength%4*8,r.getUint32(0)))}return n},Oa:function(t){function e(t){return 4<=(t+="").length?t:Array(4-t.length+1).join("0")+t}t=new DataView(t);for(var i="",r=0;r<t.byteLength;r+=2)0==r%16&&(i+="\n"+r.toString(16)+"\t"),i+=e(t.getUint16(r).toString(16))+" ";void 0===("undefined"===typeof console?"undefined":n(console))&&(console=console||{log:function(){}}),console.log(i.toUpperCase())}},function(){function t(t,e){return t<<e|t>>>32-e}function e(t){return(255&t)<<24|(65280&t)<<8|(16711680&t)>>>8|(-16777216&t)>>>24}function i(e){for(var i,r=this.c[0],a=this.c[1],s=this.c[2],c=this.c[3],d=this.c[4],b=this.c[0],p=this.c[1],m=this.c[2],F=this.c[3],B=this.c[4],A=0;16>A;++A)i=t(r+(a^s^c)+e[h[A]]+n[A],u[A])+d,r=d,d=c,c=t(s,10),s=a,a=i,i=t(b+(p^(m|~F))+e[f[A]]+o[A],l[A])+B,b=B,B=F,F=t(m,10),m=p,p=i;for(;32>A;++A)i=t(r+(a&s|~a&c)+e[h[A]]+n[A],u[A])+d,r=d,d=c,c=t(s,10),s=a,a=i,i=t(b+(p&F|m&~F)+e[f[A]]+o[A],l[A])+B,b=B,B=F,F=t(m,10),m=p,p=i;for(;48>A;++A)i=t(r+((a|~s)^c)+e[h[A]]+n[A],u[A])+d,r=d,d=c,c=t(s,10),s=a,a=i,i=t(b+((p|~m)^F)+e[f[A]]+o[A],l[A])+B,b=B,B=F,F=t(m,10),m=p,p=i;for(;64>A;++A)i=t(r+(a&c|s&~c)+e[h[A]]+n[A],u[A])+d,r=d,d=c,c=t(s,10),s=a,a=i,i=t(b+(p&m|~p&F)+e[f[A]]+o[A],l[A])+B,b=B,B=F,F=t(m,10),m=p,p=i;for(;80>A;++A)i=t(r+(a^(s|~c))+e[h[A]]+n[A],u[A])+d,r=d,d=c,c=t(s,10),s=a,a=i,i=t(b+(p^m^F)+e[f[A]]+o[A],l[A])+B,b=B,B=F,F=t(m,10),m=p,p=i;i=this.c[1]+s+F,this.c[1]=this.c[2]+c+B,this.c[2]=this.c[3]+d+b,this.c[3]=this.c[4]+r+p,this.c[4]=this.c[0]+a+m,this.c[0]=i}a.hash.ripemd160=function(t){t?(this.c=t.c.slice(0),this.h=t.h.slice(0),this.f=t.f):this.reset()},a.hash.ripemd160.hash=function(t){return(new a.hash.ripemd160).update(t).finalize()},a.hash.ripemd160.prototype={reset:function(){return this.c=r.slice(0),this.h=[],this.f=0,this},update:function(t){"string"===typeof t&&(t=a.codec.utf8String.toBits(t));var r,n=this.h=a.bitArray.concat(this.h,t);if(r=this.f,9007199254740991<(t=this.f=r+a.bitArray.bitLength(t)))throw new a.exception.invalid("Cannot hash more than 2^53 - 1 bits");for(r=512+r-(512+r&511);r<=t;r+=512){for(var o=n.splice(0,16),s=0;16>s;++s)o[s]=e(o[s]);i.call(this,o)}return this},finalize:function(){var t,r=a.bitArray.concat(this.h,[a.bitArray.partial(1,1)]),n=(t=(448<(t=(this.f+1)%512)?512:448)-t%448)%32;for(0<n&&(r=a.bitArray.concat(r,[a.bitArray.partial(n,0)]));32<=t;t-=32)r.push(0);for(r.push(e(0|this.f)),r.push(e(Math.floor(this.f/4294967296)));r.length;){for(n=r.splice(0,16),t=0;16>t;++t)n[t]=e(n[t]);i.call(this,n)}for(r=this.c,this.reset(),t=0;5>t;++t)r[t]=e(r[t]);return r}};for(var r=[1732584193,4023233417,2562383102,271733878,3285377520],n=[0,1518500249,1859775393,2400959708,2840853838],o=[1352829926,1548603684,1836072691,2053994217,0],s=4;0<=s;--s)for(var c=1;16>c;++c)n.splice(s,0,n[s]),o.splice(s,0,o[s]);var h=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],f=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],u=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],l=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]}(),t.exports&&(t.exports=a),void 0===(r=function(){return a}.apply(e,[]))||(t.exports=r)}};